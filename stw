#!/usr/bin/env bash

PROJECT_PATH="$HOME/projects/riot"

# docker-compose -p riot-cloud -f docker-compose/riot-cloud-env.yml up -d
function startOne() {
    CONTAINER_ID=$(docker create \
        -p 8080:8080 -v ~/temp/config/extensionsConfig.js:/usr/local/riot-one/config/extensionsConfig.js \
        --link mqtt:mqtt \
        registry.greenwavereality.com/axon/axon-riot-one:1.3.0-SNAPSHOT)
    # CONTAINER_ID=$(docker create \
    #     -p 8080:8080 \
    #     registry.greenwavereality.com/axon/axon-riot-one:1.3.0-SNAPSHOT)
    docker start $CONTAINER_ID
    docker attach $CONTAINER_ID
    docker rm $CONTAINER_ID
}

function startCloud() {
    CONTAINER_ID=$(docker create -p 8080:8080 registry.greenwavereality.com/axon/axon-riot-cloud:2.0.0-SNAPSHOT)
    docker start $CONTAINER_ID
    docker attach $CONTAINER_ID
    docker rm $CONTAINER_ID
}

function startUI() {
    cd "$PROJECT_PATH/riot-ui";
    npm run $2;
}

function startMqtt() {
    CONTAINER_ID=$(docker create -p 1883:1883 --name mqtt toke/mosquitto)
    docker start $CONTAINER_ID
    docker attach $CONTAINER_ID
    docker rm $CONTAINER_ID
}

case "$1" in
    "one") startOne $*;;
    "ui") startUI $*;;
    "cloud") startCloud $*;;
    "mqtt") startMqtt $*;;
    *)echo "Unknown command";;
esac
